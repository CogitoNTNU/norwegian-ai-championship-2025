# Emergency Healthcare RAG

![Kiku](../images/emergency-rag-banner.png)

In this use case, your job is to help an emergency department answer critical medical questions fast and accurately!

You will receive medical statements about emergency healthcare conditions that need to be evaluated for truth and classified by topic. Each statement must be processed in two ways:

- **Binary classification**: Determine if the statement is true or false
- **Multi-class classification**: Identify which medical topic the statement concerns

The dataset (`data/`) comprises medical statements generated by Claude Opus based on reference articles covering 115 emergency healthcare topics (`data/topics/`). Your predictions will be scored by accuracy for both the binary classification (true/false) and multi-class classification (topic identification):

$$
Accuracy = \\frac{\\text{Number of correct predictions}}{\\text{Total number of predictions}}
$$

The training set, validation set and evaluation set contain 200, 200 and 749 statements respectively. All statements are generated based on the medical reference material found in `data/topics/`. The medical topics range from emergency conditions like stroke, cardiac arrest, and trauma to diagnostic procedures like CT scans, blood tests, and ECGs. The complete topic mapping is provided in `data/topics.json`.

### Example Statement

**Statement**: "Cancer patients with pulmonary embolism have the highest VTE recurrence risk with pancreatic cancer, hematological malignancies, lung cancer, gastric cancer, and brain cancer carrying the greatest thrombotic risk, necessitating extended anticoagulation with LMWH or direct oral anticoagulants preferred over vitamin K antagonists."

**Expected Output**:

```json
{
  "statement_is_true": 1,
  "statement_topic": 63
}
```

*Topic 63 corresponds to "Pulmonary Embolism" in the topic mapping.*

## Constraints

Since this is an emergency department scenario, your solution must operate under strict constraints:

- **Speed**: Maximum 5 seconds per statement evaluation
- **Privacy**: Must run completely offline - no cloud API calls during inference
- **Memory**: Maximum 24GB VRAM usage at any time during inference

## Evaluation

During the week of the competition, you will be able to validate your solution against the validation set. You can do this multiple times, however, **you can only submit to the evaluation set once!** The best validation and evaluation score your model achieves will be displayed on the <a href="https://cases.dmiai.dk/teams"> scoreboard</a>. We encourage you to validate your code and API before you submit your final model to evaluation.

## Quickstart

Navigate to the Emergency Healthcare RAG directory:

```bash
cd src/rag
```

Install dependencies:

```bash
uv sync
```

Make a local prediction using the baseline model:

```bash
uv run python example.py
```

## Validation

Submit your solution for validation:

```bash
# Submit for validation
uv run validate

# Check validation status
uv run check-status <uuid>

# Submit and wait for completion
uv run validate --wait
```

## API Testing

The unified API serves all tasks with auto port cleanup and hot reload:

```bash
cd ../shared
uv sync       # Install all API dependencies
uv run api    # Start API with auto port cleanup
```

**Features:**

- ✅ **Auto port cleanup** - Kills any existing process on port 8000
- ✅ **Hot reload** - Automatically restarts when code changes
- ✅ **All dependencies** - Includes FastAPI, NumPy, Loguru, and more

Test the healthcare endpoint at `http://localhost:8000/healthcare/predict`:

```bash
curl -X POST http://localhost:8000/healthcare/predict \
     -H "Content-Type: application/json" \
     -d '{"statement": "Aspirin can help reduce fever and pain."}'
```

**Expected Response:**

```json
{"statement_is_true": 1, "statement_topic": 0}
```

## About the data

The medical statements have been generated by Claude Opus based on StatPearls medical reference articles (`data/topics`). Medical topics include emergency conditions such as stroke, myocardial infarction, respiratory failure, and trauma, as well as diagnostic procedures like ECG interpretation, blood gas analysis, and medical imaging. The complete list of 115 topics is available in `data/topics.json`.

## Tips & Getting Started

**Retrieval-Augmented Generation (RAG)** can be used with the reference articles in `data/topics/`.
[ucloud/getting-started.md](https://github.com/amboltio/DM-i-AI-2025/blob/main/emergency-healthcare-rag/ucloud/getting-started.md)

### Offline LLM Frameworks

- **Ollama**, **llama.cpp**, **vLLM**, **Transformers** (Hugging Face)

### Performance Factors

Things like **model size**, **quantization** and **context length**, affect VRAM usage and inference speed.

## Acknowledgements

MD Caroline Schrøder for helping design the challenge
